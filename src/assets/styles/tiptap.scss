.tiptap {
  padding: 10px;
  min-height: 500px;
  font-size: 1rem;
  width: 100%;

  /* ğŸ”¥ æ··åˆè™šæ‹ŸåŒ–æ–¹æ¡ˆï¼šcontent-visibility + Decoration æ ‡è®° */
  > * {
    content-visibility: auto;
    contain-intrinsic-size: auto 80px; /* é¢„ä¼°é«˜åº¦ 80pxï¼Œæµè§ˆå™¨è‡ªåŠ¨è®°ä½çœŸå®é«˜åº¦ */
  }

  /* ğŸ¯ é’ˆå¯¹ä¸åŒç±»å‹çš„å—ä¼˜åŒ–é¢„ä¼°é«˜åº¦ */
  > p {
    contain-intrinsic-size: auto 60px;
  }

  > h1 {
    contain-intrinsic-size: auto 80px;
  }

  > h2 {
    contain-intrinsic-size: auto 70px;
  }

  > h3,
  > h4,
  > h5,
  > h6 {
    contain-intrinsic-size: auto 60px;
  }

  > pre {
    contain-intrinsic-size: auto 200px;
  }

  > blockquote {
    contain-intrinsic-size: auto 100px;
  }

  > ul,
  > ol {
    contain-intrinsic-size: auto 120px;
  }

  > table {
    contain-intrinsic-size: auto 300px;
  }

  > .image-wrapper,
  > div[data-type='image'] {
    contain-intrinsic-size: auto 400px;
  }

  /* ğŸ”¥ VirtualScroll æ’ä»¶çš„è™šæ‹ŸåŒ–æ ‡è®°ï¼ˆä¸ Decoration é…åˆï¼‰ */
  .virtual-hidden {
    /* æ ¸å¿ƒç­–ç•¥ï¼šå®Œå…¨éšè—å†…å®¹æ¸²æŸ“ï¼Œåªä¿ç•™å ä½ç©ºé—´ */
    content-visibility: hidden !important; /* å¼ºåˆ¶ä¸æ¸²æŸ“å†…å®¹ */
    contain: strict; /* ä¸¥æ ¼éš”ç¦»ï¼ˆlayout + paint + sizeï¼‰ */

    /* æ¸…ç©ºæ‰€æœ‰è§†è§‰å†…å®¹ */
    font-size: 0 !important;
    line-height: 0 !important;
    color: transparent !important;
    overflow: hidden !important;

    /* éšè—æ‰€æœ‰å­å…ƒç´ ï¼ˆé˜²æ­¢ DOM æ¸²æŸ“ï¼‰ */
    > *,
    * {
      display: none !important;
      visibility: hidden !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }

    /* æ¸…ç©ºä¼ªå…ƒç´  */
    &::before,
    &::after {
      content: '' !important;
      display: none !important;
    }

    /* ğŸ¯ å…³é”®ä¿®å¤ï¼šé˜²æ­¢æ»šåŠ¨æ¡è·³åŠ¨ */
    /* min-height å’Œ height ç”± Decoration çš„ style å±æ€§åŠ¨æ€è®¾ç½® */
    box-sizing: border-box !important;
    flex-shrink: 0 !important; /* é˜²æ­¢ flex å¸ƒå±€ä¸‹è¢«å‹ç¼© */
  }

  /* ğŸ”§ å¯è§†åŒ–è°ƒè¯•æ¨¡å¼ï¼ˆenableVisualDebug: trueï¼‰ */
  .virtual-debug {
    &[data-virtualized='true'] {
      /* è™šæ‹ŸåŒ–å—ï¼šçº¢è‰²è¾¹æ¡† */
      outline: 2px dashed rgba(255, 77, 79, 0.6) !important;
      outline-offset: -2px;
      background: repeating-linear-gradient(
        45deg,
        rgba(255, 77, 79, 0.05) 0px,
        rgba(255, 77, 79, 0.05) 10px,
        rgba(255, 77, 79, 0.1) 10px,
        rgba(255, 77, 79, 0.1) 20px
      ) !important;
    }
  }

  [data-virtualized='false'] {
    /* çœŸå®æ¸²æŸ“å—ï¼šç»¿è‰²è¾¹æ¡†ï¼ˆä»…è°ƒè¯•æ¨¡å¼ï¼‰ */
    &.virtual-debug {
      outline: 2px solid rgba(82, 196, 26, 0.4) !important;
      outline-offset: -2px;
    }
  }

  /* âŒ æ—§çš„è™šæ‹ŸåŒ–æ ·å¼ï¼ˆå·²åºŸå¼ƒï¼Œä¿ç•™ç”¨äºå¯¹æ¯”ï¼‰ */
  .virtual-hidden-deprecated {
    /* æ ¸å¿ƒç­–ç•¥ï¼šå®Œå…¨éšè—å†…å®¹ï¼Œåªä¿ç•™å ä½ç©ºé—´ */

    /* æ–¹æ³•1ï¼šæ¸…ç©ºæ–‡æœ¬å†…å®¹ï¼ˆæœ€å½»åº•ï¼‰ */
    font-size: 0 !important;
    line-height: 0 !important;
    color: transparent !important;
    text-indent: -9999px !important;
    overflow: hidden !important;

    /* æ–¹æ³•2ï¼šéšè—æ‰€æœ‰å­å…ƒç´ å’Œæ–‡æœ¬èŠ‚ç‚¹ */
    visibility: hidden !important;

    /* æ–¹æ³•3ï¼šå¼ºåˆ¶æœ€å°é«˜åº¦ï¼ˆä½¿ç”¨ data å±æ€§ï¼‰ */
    min-height: attr(data-virtual-height px, 80px) !important;
    max-height: attr(data-virtual-height px, 80px) !important;

    /* ç§»é™¤æ‰€æœ‰å­å…ƒç´ ï¼ˆé˜²æ­¢æ¸²æŸ“ï¼‰ */
    > *,
    * {
      display: none !important;
      visibility: hidden !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }

    /* æ¸…ç©ºä¼ªå…ƒç´  */
    &::before,
    &::after {
      content: '' !important;
      display: none !important;
    }

    /* æ€§èƒ½ä¼˜åŒ–ï¼šCSS Containment */
    contain: strict;
    content-visibility: hidden;

    /* é˜²æ­¢å†…å®¹æº¢å‡º */
    white-space: nowrap;
    text-overflow: clip;

    /* è°ƒè¯•æ¨¡å¼ï¼šæ˜¾ç¤ºå ä½ç¬¦èƒŒæ™¯ */
    &[data-cached='false'] {
      /* æœªç¼“å­˜ï¼šä½¿ç”¨é¢„ä¼°é«˜åº¦ï¼Œæµ…ç°è‰²èƒŒæ™¯ */
      background: repeating-linear-gradient(
        90deg,
        #fafafa 0px,
        #fafafa 20px,
        #f5f5f5 20px,
        #f5f5f5 40px
      ) !important;
      border-left: 2px solid #e0e0e0 !important;
      /* æ¢å¤å¯è§æ€§ä»¥æ˜¾ç¤ºèƒŒæ™¯ */
      visibility: visible !important;
    }

    &[data-cached='true'] {
      /* å·²ç¼“å­˜ï¼šä½¿ç”¨çœŸå®é«˜åº¦ï¼Œæ·±ç°è‰²èƒŒæ™¯ */
      background: repeating-linear-gradient(
        90deg,
        #f5f5f5 0px,
        #f5f5f5 20px,
        #f0f0f0 20px,
        #f0f0f0 40px
      ) !important;
      border-left: 2px solid #d0d0d0 !important;
      /* æ¢å¤å¯è§æ€§ä»¥æ˜¾ç¤ºèƒŒæ™¯ */
      visibility: visible !important;
    }

    /* ç”Ÿäº§æ¨¡å¼ï¼šç§»é™¤è°ƒè¯•èƒŒæ™¯ï¼ˆå–æ¶ˆæ³¨é‡Šä¸‹é¢çš„ä»£ç ï¼‰ */
    /*
    &[data-cached="false"],
    &[data-cached="true"] {
      background: transparent !important;
      border-left: none !important;
    }
    */
  }
  ul,
  ol {
    margin-left: 10px;
    outline: inherit;
    list-style: inherit;
  }
  ol {
    list-style: auto;
  }
  blockquote {
    border-left: 5px solid $gray-300;
    margin: 1.5rem 0;
    padding: 10px;
    padding-left: 20px;
    background-color: $gray-100;
  }
  table {
    display: inline-block !important;
    font-size: 12px;
    width: auto;
    max-width: 100%;
    overflow: auto;
    border: 1px solid #f6f6f6;

    th {
      background-color: $gray-200;
      color: #000;
      text-align: left;
      box-sizing: border-box;
      padding: 12px 7px;
      line-height: 24px;
      min-width: 100px;
    }
    td {
    }
    // th {
    //   padding: 12px 7px;
    //   line-height: 24px;
    // }
  }

  .code-block {
    position: relative;
    select {
      position: absolute;
      background-color: white;
      outline: none;
      border: none;
      border-radius: 0.5rem;
      font-family:
        'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande',
        'Lucida Sans Unicode', Geneva, Verdana, sans-serif;

      right: 0.5rem;
      top: 0.5rem;
    }
  }

  pre {
    background: black;
    border-radius: 0.5rem;
    color: white;
    margin-bottom: 10px;
    margin-top: 10px;
    padding: 1.3rem 1rem;

    code {
      background: none;
      color: inherit;
      font-family: 'Consolas', 'KaiTi', 'Microsoft Yahei', 'SimHei';
      font-size: 0.9rem;
      padding: 0;
    }

    /* Code styling */
    .hljs-comment,
    .hljs-quote {
      color: #616161;
    }

    .hljs-variable,
    .hljs-template-variable,
    .hljs-attribute,
    .hljs-tag,
    .hljs-name,
    .hljs-regexp,
    .hljs-link,
    .hljs-name,
    .hljs-selector-id,
    .hljs-selector-class {
      color: #f98181;
    }

    .hljs-number,
    .hljs-meta,
    .hljs-built_in,
    .hljs-builtin-name,
    .hljs-literal,
    .hljs-type,
    .hljs-params {
      color: #fbbc88;
    }

    .hljs-string,
    .hljs-symbol,
    .hljs-bullet {
      color: #b9f18d;
    }

    .hljs-title,
    .hljs-section {
      color: #faf594;
    }

    .hljs-keyword,
    .hljs-selector-tag {
      color: #70cff8;
    }

    .hljs-emphasis {
      font-style: italic;
    }

    .hljs-strong {
      font-weight: 700;
    }

    // æ ‡é¢˜
  }
  &:focus {
    outline: none;
  }
}

.editor-container {
  // ç›®å½•æ ·å¼
  .sidebar-options {
    align-items: flex-start;
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: 1rem;
    position: sticky;
    top: 1rem;
    .label-large {
      font-size: 1rem;
    }
    .table-of-contents {
      display: flex;
      flex-direction: column;
      font-size: 1rem;

      gap: 0.25rem;
      overflow: auto;
      text-decoration: none;

      > div {
        border-radius: 0.25rem;
        padding-left: calc(0.875rem * (var(--level) - 1));
        transition: all 0.2s cubic-bezier(0.65, 0.05, 0.36, 1);

        &:hover {
          background-color: var(--gray-2);
        }
      }
      // ç©ºæ–‡å­—
      .empty-state {
        color: $gray-700;
        user-select: none;
      }

      .is-active a {
        color: var(--purple);
      }

      .is-scrolled-over a {
        color: $gray-700;
      }

      a {
        display: flex;
        gap: 0.25rem;
        text-decoration: none;
        color: $text-secondary;
        // &::before {
        //   content: attr(data-item-index) '.';
        // }
        &:hover {
          color: $text-primary;
        }
        &:active {
          color: #70cff8;
        }
      }
    }
  }
}

.virtual-suggestion {
  position: absolute;
  pointer-events: none;
  color: #888;
  font-family: Monaco, Menlo, 'Ubuntu Mono', monospace;
  font-size: 14px;
  opacity: 0.7;
  z-index: 1000;
  background: rgba(0, 123, 255, 0.1);
  border: 1px solid rgba(0, 123, 255, 0.3);
  border-radius: 4px;
  padding: 2px 6px;
  white-space: pre-wrap;
  word-break: break-word;
  max-width: 300px;
  box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
}
/* è™šæ‹ŸåŒ–å ä½ç¬¦æ ·å¼ */
// .virtual-block-placeholder {
//   transition: all 0.3s ease;
//   cursor: pointer;

//   &:hover {
//     background: #fafafa !important;
//     border-color: #40a9ff !important;
//     color: #40a9ff !important;
//   }
// }

// /* è¢«è™šæ‹ŸåŒ–/éè™šæ‹ŸåŒ–èŠ‚ç‚¹çš„å¯è§†åŒ–æ ‡è®°ï¼ˆä»…è°ƒè¯•è§‚æ„Ÿï¼Œä¸å½±å“å¸ƒå±€ï¼‰ */
// [data-block-id] {
//   outline: 1px dashed rgba(24, 144, 255, 0.15);
//   outline-offset: -1px;
// }

// [data-virtualized='true'] {
//   outline-color: rgba(255, 77, 79, 0.45) !important;
// }
// [data-virtualized='false'] {
//   outline-color: rgba(82, 196, 26, 0.35) !important;
// }

// /* æ‡’åŠ è½½å›¾ç‰‡æ ·å¼ */
// .lazy-image {
//   opacity: 0;
//   transition: opacity 0.3s ease-in;

//   &.loaded {
//     opacity: 1;
//   }

//   &.error {
//     opacity: 0.5;
//     border: 2px dashed #ff4d4f;
//   }
// }

// /* æ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘é‡ç»˜ */
// .ProseMirror {
//   will-change: transform;
//   contain: layout style paint;
// }

// /* å¤§å‹èŠ‚ç‚¹ä¼˜åŒ– */
// .ProseMirror {
//   table {
//     contain: layout;
//   }

//   pre {
//     contain: layout style;
//   }

//   p {
//     contain: layout style;
//   }
// }
